webpackJsonp(["app/js/course-manage/index"],{d14d05cad9e7abf02a5d:function(e,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=s.toggleIcon=function(e,s,a){var t=e.find(".js-remove-icon"),n=e.find(".js-remove-text");t.hasClass(s)?(t.removeClass(s).addClass(a),n?n.text(Translator.trans("收起")):""):(t.removeClass(a).addClass(s),n?n.text(Translator.trans("展开")):"")};s.chapterAnimate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"body",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:".js-task-chapter",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"es-icon-remove",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"es-icon-anonymous-iconfont";$(e).on("click",s,function(e){var i=$(e.currentTarget);i.nextUntil(s).animate({height:"toggle",opacity:"toggle"},"normal"),a(i,t,n)})}},"4e68e437f5b716377a9d":function(e,s,a){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(s,"__esModule",{value:!0}),s.TaskListHeaderFixed=s.updateTaskNum=s.TabChange=s.showSettings=s.unpublishTask=s.publishTask=s.deleteTask=s.publishCourse=s.deleteCourse=s.closeCourse=s.taskSortable=s.sortablelist=void 0;var n=a("b334fd7e4c5a19234db2"),i=t(n),r=a("8f840897d9471c8c1fbd"),o=t(r),l=s.sortablelist=function(e){var s=$(e),a=s.sortable("serialize").get();$.post(s.data("sortUrl"),{ids:a},function(e){var a=0,t=0,n=0;s.find(".task-manage-item").each(function(){var e=$(this);e.hasClass("js-task-manage-item")?e.find(".number").length>0&&(a++,e.find(".number").text(a)):e.hasClass("task-manage-unit")?(n++,e.find(".number").text(n)):e.hasClass("task-manage-chapter")&&(t++,n=0,e.find(".number").text(t))}),s.trigger("finished")})};s.taskSortable=function(e){$(e).length&&(0,o.default)({element:e,ajax:!1},function(s){l(e)})},s.closeCourse=function(){$("body").on("click",".js-close-course",function(e){var s=$(e.currentTarget);confirm(Translator.trans("course.manage.close_hint"))&&$.post(s.data("check-url"),function(e){e.warn&&!confirm(Translator.trans(e.message))||$.post(s.data("url"),function(e){e.success?((0,i.default)("success",Translator.trans("course.manage.close_success_hint")),location.reload()):(0,i.default)("danger",Translator.trans("course.manage.close_fail_hint")+":"+e.message)})})})},s.deleteCourse=function(){$("body").on("click",".js-delete-course",function(e){confirm(Translator.trans("course.manage.delete_hint"))&&$.post($(e.currentTarget).data("url"),function(e){e.success?((0,i.default)("success",Translator.trans("site.delete_success_hint")),location.reload()):(0,i.default)("danger",Translator.trans("site.delete_fail_hint")+":"+e.message)})})},s.publishCourse=function(){$("body").on("click",".js-publish-course",function(e){confirm(Translator.trans("course.manage.publish_hint"))&&$.post($(e.target).data("url"),function(e){e.success?((0,i.default)("success",Translator.trans("course.manage.task_publish_success_hint")),location.reload()):(0,i.default)("danger",Translator.trans("course.manage.task_publish_fail_hint")+":"+e.message,{delay:5e3})})})},s.deleteTask=function(){$("body").on("click",".delete-item",function(e){if("task"==$(e.currentTarget).data("type")){if(!confirm(Translator.trans("course.manage.task_delete_hint")))return}else if("chapter"==$(e.currentTarget).data("type")&&!confirm(Translator.trans("course.manage.chapter_delete_hint")))return;$.post($(e.currentTarget).data("url"),function(s){s.success?((0,i.default)("success",Translator.trans("site.delete_success_hint")),$(e.target).parents(".task-manage-item").remove(),l("#sortable-list"),$("#sortable-list").children("li").length<1&&$(".js-task-empty").hasClass("hidden")&&$(".js-task-empty").removeClass("hidden"),document.location.reload()):(0,i.default)("danger",Translator.trans("site.delete_fail_hint")+":"+s.message)})})},s.publishTask=function(){$("body").on("click",".publish-item",function(e){$.post($(e.target).data("url"),function(s){if(s.success){var a=$(e.target).closest(".task-manage-item");(0,i.default)("success",Translator.trans("course.manage.task_publish_success_hint")),$(a).find(".publish-item").addClass("hidden"),$(a).find(".delete-item").addClass("hidden"),$(a).find(".unpublish-item").removeClass("hidden"),$(a).find(".publish-status").addClass("hidden")}else(0,i.default)("danger",Translator.trans("course.manage.task_publish_fail_hint")+":"+s.message)})})},s.unpublishTask=function(){$("body").on("click",".unpublish-item",function(e){$.post($(e.target).data("url"),function(s){if(s.success){var a=$(e.target).closest(".task-manage-item");(0,i.default)("success",Translator.trans("course.manage.task_unpublish_success_hint")),$(a).find(".publish-item").removeClass("hidden"),$(a).find(".delete-item").removeClass("hidden"),$(a).find(".unpublish-item").addClass("hidden"),$(a).find(".publish-status").removeClass("hidden")}else(0,i.default)("danger",Translator.trans("course.manage.task_unpublish_fail_hint")+":"+s.message)})})},s.showSettings=function(){$("#sortable-list").on("click",".js-item-content",function(e){var s=$(e.currentTarget),a=s.closest(".js-task-manage-item");a.hasClass("active")?a.removeClass("active").find(".js-settings-list").stop().slideUp(500):(a.addClass("active").find(".js-settings-list").stop().slideDown(500),a.siblings(".js-task-manage-item.active").removeClass("active").find(".js-settings-list").hide())})},s.TabChange=function(){$('[data-role="tab"]').click(function(e){var s=$(this);$(s.data("tab-content")).removeClass("hidden").siblings('[data-role="tab-content"]').addClass("hidden")})},s.updateTaskNum=function(e){},s.TaskListHeaderFixed=function(){var e=$(".js-task-list-header");if(e.length){var s=e.offset().top;$(window).scroll(function(a){$(window).scrollTop()>=s?e.addClass("fixed"):e.removeClass("fixed")})}}},0:function(e,s,a){"use strict";var t=a("4e68e437f5b716377a9d"),n=a("d14d05cad9e7abf02a5d");$('[data-help="popover"]').popover();var i="#sortable-list";(0,t.taskSortable)(i),(0,t.updateTaskNum)(i),(0,t.closeCourse)(),(0,t.deleteCourse)(),(0,t.deleteTask)(),(0,t.publishTask)(),(0,t.unpublishTask)(),(0,t.showSettings)(),(0,t.TaskListHeaderFixed)(),$("#sortable-list").on("click",".js-chapter-toggle-show",function(e){var s=$(e.currentTarget),a=s.closest(".js-task-manage-chapter");a.nextUntil(".js-task-manage-chapter").animate({height:"toggle",opacity:"toggle"},"normal"),(0,n.toggleIcon)(a,"es-icon-keyboardarrowdown","es-icon-keyboardarrowup")})}});