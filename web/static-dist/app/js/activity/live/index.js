webpackJsonp(["app/js/activity/live/index"],{0:function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var n=i("c6797855be84e924b7d5"),s=a(n);window.liveShow=new s.default},c6797855be84e924b7d5:function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),r=i("da32dea28c2b82c7aab1"),o=a(r),l=function(){function t(){n(this,t),this.init()}return s(t,[{key:"init",value:function(){var t=this,e="1"==$("#lesson-live-content").data("hasRoom");if(!e)return $("#lesson-live-content").find(".lesson-content-text-body").html("<div class='live-show-item'>\n        <p class='title'>"+Translator.trans("site.activity.live.content_title")+"</p>\n        <p>"+Translator.trans("activity.liva.not_created_notice")+"ÔºÅ</p>\n        </div>"),void $("#lesson-live-content").show();var i=JSON.parse($("#activity-data").html()),a=(parseInt(i.startTime),parseInt(i.endTime)),n=parseInt(i.nowDate);this.liveStartTimeFormat=i.startTimeFormat,this.liveEndTimeFormat=i.endTimeFormat;var s=i.fromCourseId,r=i.id;this.summary=$("#activity-summary").text(),this.$liveNotice='<div class="live-show-item">\n          <p class="title">'+Translator.trans("activity.live.notice_title")+"</p>\n           "+Translator.trans("activity.live.default_notice",{startTimeFormat:this.liveStartTimeFormat,endTimeFormat:this.liveEndTimeFormat})+"\n         </div>",this.iID=null,this.iID&&clearInterval(iID),this.intervalSecond=0,this.entry_url=location.protocol+"//"+location.hostname+"/course/"+s+"/activity/"+r+"/live_entry",this.generateHtml();var o=0;a>n&&(o=1e3),this.iID=setInterval(function(){t.generateHtml()},o),$("#lesson-live-content").show(),this.started=!1}},{key:"entryLiveRoom",value:function(){if(!this.started){this.started=!0;var t=new o.default;t.emit("start",{}).then(function(){}).catch(function(t){})}window.open(this.entry_url,"_blank")}},{key:"generateHtml",value:function(){var t=JSON.parse($("#activity-data").text()),e=parseInt(t.startTime),i=parseInt(t.endTime),a=parseInt(t.nowDate);a+=this.intervalSecond;var n=parseInt(e-a),s=parseInt(i-a),r=Math.floor(n/86400),o=n%86400,l=Math.floor(o/3600);o%=3600;var v=Math.floor(o/60),c=o%60,d="";d=1==t.ext.liveProvider?Translator.trans("activity.live.replay_guid_1"):Translator.trans("activity.live.replay_guid"),d="<div class='live-show-item'>"+d+"</div>";var m=this._getCountDown(r,l,v,c),h="";0<n&&n<7200&&(this.$liveNotice='<div class="live-show-item">\n          <p class="title">'+Translator.trans("activity.live.notice_title")+"</p>\n          "+Translator.trans("activity.live.default_notice",{startTimeFormat:this.liveStartTimeFormat,endTimeFormat:this.liveEndTimeFormat})+"\n         </div>",h="<div class='live-show-item'>\n          <a class='btn btn-primary js-start-live' href='javascript:;'\n            onclick='$(liveShow.entryLiveRoom())'>\n           "+Translator.trans("activity.live.entry_live_room")+"\n          </a>\n        </div>",t.isTeacher&&(h+=d)),n<=0&&(clearInterval(this.iID),m="",this.$liveNotice="<div class='live-show-item'>\n          <p class=\"title\">"+Translator.trans("activity.live.notice_title")+"</p>\n          "+Translator.trans("activity.live.started_notice",{endTimeFormat:this.liveEndTimeFormat})+"\n        </div>",h="<div class='live-show-item'>\n          <a class='btn btn-primary js-start-live' href='javascript:;'\n            onclick='$(liveShow.entryLiveRoom())'>\n            "+Translator.trans("activity.live.entry_live_room")+"\n          </a>\n        </div>",t.isTeacher&&(h+=d)),s<=0&&(m="",h="",this.$liveNotice="<div class='live-show-item'>\n          <i class='es-icon es-icon-xinxi color-danger icon-live-end'></i>\n          "+Translator.trans("activity.live.ended_notice")+"\n        </div>",t.replays&&t.replays.length>0&&($.each(t.replays,function(t,e){h+="<a class='btn btn-primary btn-replays' href='"+e.url+"' target='_blank'>"+e.title+"</a>"}),h="<div class='live-show-item'>"+h+"</div>"));var u=this.$liveNotice+" "+m+"\n      <div class='live-show-item'>\n        <p class='title'>"+Translator.trans("activity.live.content_title")+"</p>\n        "+this.summary+"\n      </div>"+h;$("#lesson-live-content").find(".lesson-content-text-body").html(u),this.intervalSecond++}},{key:"_getCountDown",value:function(t,e,i,a){var n="";return n+=t?Translator.trans("site.date_format_dhis",{days:t,hours:e,minutes:i,seconds:a}):"",n+=e?Translator.trans("site.date_format_his",{hours:e,minutes:i,seconds:a}):"",n+=i?Translator.trans("site.date_format_is",{minutes:i,seconds:a}):"",n+=a?Translator.trans("site.date_format_s",{seconds:a}):"",n="<div class='live-show-item'>\n      <p class='title'>"+Translator.trans("activity.live.count_down_title")+'</p>\n      <span class="color-warning">'+n+"</span>\n    </div>"}}]),t}();e.default=l}});